<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.10: http://docutils.sourceforge.net/" />
<title>Cable d'interface pour Raspberry Pi</title>
<meta name="date" content="2013-01-19" />
<meta name="author" content="François Dion" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7514 2012-09-14 14:27:12Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="cable-d-interface-pour-raspberry-pi">
<h1 class="title">Cable d'interface pour Raspberry Pi</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Date:</th>
<td>2013-01-19</td></tr>
<tr class="field"><th class="docinfo-name">category:</th><td class="field-body">ecologie,informatique,electronique</td>
</tr>
<tr class="field"><th class="docinfo-name">level:</th><td class="field-body">vulgarisation</td>
</tr>
<tr><th class="docinfo-name">Author:</th>
<td>François Dion</td></tr>
</tbody>
</table>
<div class="figure">
<img alt="cable-final.jpg" src="cable-final.jpg" />
<p class="caption">Exemple de circuit fait main relié a un Raspberry Pi, avec un cable fait main.</p>
</div>
<p>Une des fonctions qui ont contribuées au succès du Raspberry Pi, c'est la possibilité d'interface avec le monde extérieur. On parle ici des GPIO (en anglais les General Purpose Input and Output – entrées et sorties pour tout usage), qui se retrouvent au connecteur P1. En fabricant notre propre câble, on pourra se connecter à des DELs, des moteurs ou autres composantes physiques.</p>
<hr class="docutils" />
<div class="section" id="comment-faire-un-cable-d-interface-gpio">
<h1>Comment faire un cable d'interface GPIO</h1>
<p>Nous allons faire du recyclage, aujourd'hui. En effet, le type de câble que l'on va faire, soit un câble plat a 26 conducteurs, est très près d'un câble très commun que l'on peut retrouver un peu partout, soit dans le fond d'un tiroir, dans une boite de vieux composantes d'ordinateur. Il suffit de fouiller un peu, il y en a des dizaines de millions qui ne demandent qu'à se rendre utile une autre fois.</p>
<p>De quoi s'agit t'il? D'un câble plat pour disque dur IDE (ou ATA) a 40 conducteurs. Bien que l'on peut aussi utiliser un câble ATA66/133 à 80 conducteurs, c'est beaucoup plus de boulot, et c'est possible que l'on se retrouve avec un câble qui ne fonctionne pas, du à un court-circuit entre la mise à la masse et notre signal. Je recommande donc plutôt les câbles à 40 conducteurs, plus vieux et très commun:</p>
<div class="figure">
<img alt="ide40.jpg" src="ide40.jpg" />
<p class="caption">Cable IDE pour disque dur, 40 conducteurs.</p>
</div>
</div>
<div class="section" id="au-boulot">
<h1>Au boulot</h1>
<p>Nous aurons besoin de 2 connecteurs, et pas de 3. Avec un câble comme celui de la photo, on coupe une section avec des ciseaux:</p>
<div class="figure">
<img alt="couper.jpg" src="couper.jpg" />
<p class="caption">On coupe l'extra avec des ciseaux.</p>
</div>
<p>Maintenant, on doit faire une division du câble. En effet, on n'a besoin que de 26 conducteurs, et on en a 40. Avec le fil rouge a gauche, on compte 26 fils et on marque avec un feutre permanent la division. On compte du cote droit pour s'assurer que l'on a bien 14 fils, pas un de plus ou de moins.</p>
<div class="figure">
<img alt="marquer.jpg" src="marquer.jpg" />
<p class="caption">Marquer au feutre une ligne qui délimite 26 et 14 conducteurs.</p>
</div>
<p>La prochaine étape consiste a faire une incision avec un couteau genre X-acto ou un scalpel, dans la rainure entre les 2 fils, et sans endommager l'isolation des fils. Le plus simple c'est de commencer l'incision au couteau et la finir à la main, en tirant de chaque cote de l'incision.</p>
<div class="figure">
<img alt="separer.jpg" src="separer.jpg" />
<p class="caption">Faire l'incision et séparer les 2 parties.</p>
</div>
<p>Il faut maintenant couper le connecteur exactement sur la septième rangée de trous, partant de la droite. On peut le faire avec une petite scie a découper le métal, ou encore avec une meule a découper, dans le genre Dremel.</p>
<div class="figure">
<img alt="scier.jpg" src="scier.jpg" />
<p class="caption">Faire la découpe. Ici, on a mis un connecteur male de 2x13 pour s'assurer de ne pas se tromper d'endroit.</p>
</div>
<p>On enlève la partie du dessus, puis la section de câble a 14 conducteurs, et puis finalement, après avoir fait une entaille, on enlève la partie de dessous.</p>
<div class="figure">
<img alt="enlever.jpg" src="enlever.jpg" />
<p class="caption">On enlève la portion de droite.</p>
</div>
<p>On est prêt à connecter notre câble à notre Raspberry Pi. Le fil rouge marque la position #1 sur le connecteur P1. Il faut donc insérer le câble pour que ce fil rouge soit du cote de la carte SD, et non pas du cote du connecteur RCA / video composite (jaune):</p>
<div class="figure">
<img alt="connecter.jpg" src="connecter.jpg" />
<p class="caption">Conducteur rouge sur position #1, pres de la carte SD.</p>
</div>
</div>
<div class="section" id="connections">
<h1>Connections</h1>
<p>Question de vérifier le fonctionnement de notre câble, on va faire une connexion de 2 DELs, une rouge et une verte. Pas besoin de fil ou soudure car on va simplement insérer les DELs dans les trous du câble.</p>
<p>En suivant le diagramme ci dessous:
La patte courte de la DEL rouge et de la DEL verte vont se connecter au troisième trou du cote gauche
La patte longue de la DEL rouge au deuxième trou du cote droit
La patte longue de la DEL verte au troisième trou du cote droit</p>
<div class="figure">
<img alt="2leds.jpg" src="2leds.jpg" />
</div>
</div>
<hr class="docutils" />
<div class="section" id="le-python">
<h1>Le Python</h1>
<p>On met le code dans un fichier portant le nom flashled.py</p>
<pre class="code python literal-block">
<span class="comment">#!/usr/bin/env python</span>
<span class="literal string doc">&quot;&quot;&quot; 2 DEL qui s'allument en alternance &quot;&quot;&quot;</span>
<span class="keyword namespace">import</span> <span class="name namespace">RPi.GPIO</span> <span class="keyword namespace">as</span> <span class="name namespace">gpio</span>
<span class="keyword namespace">import</span> <span class="name namespace">time</span>

<span class="name">PINR</span> <span class="operator">=</span> <span class="literal number integer">0</span>  <span class="comment"># on utilisera 2 sur un RPi V2</span>
<span class="name">PING</span> <span class="operator">=</span> <span class="literal number integer">1</span>  <span class="comment"># on utilisera 3 sur un RPi V2</span>

<span class="name">gpio</span><span class="operator">.</span><span class="name">setmode</span><span class="punctuation">(</span><span class="name">gpio</span><span class="operator">.</span><span class="name">BCM</span><span class="punctuation">)</span> <span class="comment"># broadcom mode</span>
<span class="name">gpio</span><span class="operator">.</span><span class="name">setup</span><span class="punctuation">(</span><span class="name">PINR</span><span class="punctuation">,</span> <span class="name">gpio</span><span class="operator">.</span><span class="name">OUT</span><span class="punctuation">)</span> <span class="comment"># set up red LED pin to OUTput</span>
<span class="name">gpio</span><span class="operator">.</span><span class="name">setup</span><span class="punctuation">(</span><span class="name">PING</span><span class="punctuation">,</span> <span class="name">gpio</span><span class="operator">.</span><span class="name">OUT</span><span class="punctuation">)</span> <span class="comment"># set up green LED pin to OUTput</span>

<span class="comment">#On alterne pour l'eternite</span>
<span class="keyword">try</span><span class="punctuation">:</span>
    <span class="keyword">while</span> <span class="name builtin pseudo">True</span><span class="punctuation">:</span>
        <span class="name">gpio</span><span class="operator">.</span><span class="name">output</span><span class="punctuation">(</span><span class="name">PINR</span><span class="punctuation">,</span> <span class="name">gpio</span><span class="operator">.</span><span class="name">HIGH</span><span class="punctuation">)</span>
        <span class="name">gpio</span><span class="operator">.</span><span class="name">output</span><span class="punctuation">(</span><span class="name">PING</span><span class="punctuation">,</span> <span class="name">gpio</span><span class="operator">.</span><span class="name">LOW</span><span class="punctuation">)</span>
        <span class="name">time</span><span class="operator">.</span><span class="name">sleep</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span>
        <span class="name">gpio</span><span class="operator">.</span><span class="name">output</span><span class="punctuation">(</span><span class="name">PINR</span><span class="punctuation">,</span> <span class="name">gpio</span><span class="operator">.</span><span class="name">LOW</span><span class="punctuation">)</span>
        <span class="name">gpio</span><span class="operator">.</span><span class="name">output</span><span class="punctuation">(</span><span class="name">PING</span><span class="punctuation">,</span> <span class="name">gpio</span><span class="operator">.</span><span class="name">HIGH</span><span class="punctuation">)</span>
        <span class="name">time</span><span class="operator">.</span><span class="name">sleep</span><span class="punctuation">(</span><span class="literal number integer">1</span><span class="punctuation">)</span>
<span class="keyword">except</span> <span class="name exception">KeyboardInterrupt</span><span class="punctuation">:</span>
    <span class="name">gpio</span><span class="operator">.</span><span class="name">cleanup</span><span class="punctuation">()</span>
</pre>
<p>PINR est le GPIO pour la DEL rouge (0 pour un Rpi V1 et 2 pour un V2)
PING est le GPIO pour la DEL verte (1 pour un Rpi V1 et 3 pour un V2)</p>
<p>On sélectionne le mode Broadcom (BCM), et on active les 2 GPIO comme sorties. La boucle va alterner entre DEL rouge allumée / DEL verte éteinte, et DEL rouge éteinte / DEL verte allumée. Si on fait un CTRL-C durant l'exécution, le programme termine après avoir fait le ménage, par l'entremise de gpio.cleanup().</p>
</div>
<div class="section" id="on-y-va">
<h1>On y va</h1>
<p>Normalement, on doit toujours protéger une DEL avec une résistance, pour limiter le courant. Toutefois, comme les GPIO ne peuvent fournir que 20mA et que dans ce test on allume les DELs de façon intermittente, dans ce cas ci, on peut ignorer cette résistance, sans risque.</p>
<p>Pour un usage prolonge, on va devoir ajouter une résistance en série de 220 a 360 Ohm.</p>
<p>Pour lancer le script que l'on vient de sauver, on doit le rendre exécutable, et le lancer avec permission root (sudo), à cause du module RPi.GPIO qui a besoin d'accéder en écriture à /dev/mem:</p>
<pre class="code sh literal-block">
<span class="name variable">$ </span>chmod +x flashled.py
<span class="name variable">$ </span>sudo ./flashled.py
</pre>
<p>Control-C interrompt l'execution.</p>
<div class="figure">
<img alt="del-rouge.jpg" src="del-rouge.jpg" />
<p class="caption">DEL rouge</p>
</div>
<div class="figure">
<img alt="del-vert.jpg" src="del-vert.jpg" />
<p class="caption">DEL vert</p>
</div>
<p>Ceci conclut notre petit article. Dans un prochain numéro, nous allons fabriquer un adaptateur pour plaque de prototypage.</p>
</div>
</div>
</body>
</html>
